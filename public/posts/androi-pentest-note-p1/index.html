

<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Android Pentest Note - Zoltán&#39;s Blog</title>
  <meta name="description" content="Concept Structure  AndroidManifest file contains the application’s structure Res folder contains all the resources that the application needs to run , including user interface layout, icons, audio, etc. The most interesting files for us are the classes.dex files because they are the compiled java files. The .dex extension stands for Dalvik EXecutable. So we need to decompile these dex files to get the java classes.  Tools  Apktool : tool for reverse engineering Android apk files.">
  <meta name="author" content="Zoltán Balogh"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Zoltán\u0027s Blog",
    
    "url": "https:\/\/bzoltan1.github.io\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/bzoltan1.github.io\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/bzoltan1.github.io\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/bzoltan1.github.io\/posts\/androi-pentest-note-p1\/",
          "name": "Android pentest note"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : ""
  },
  "headline": "Android Pentest Note",
  "description" : "Concept Structure  AndroidManifest file contains the application’s structure Res folder contains all the resources that the application needs to run , including user interface layout, icons, audio, etc. The most interesting files for us are the classes.dex files because they are the compiled java files. The .dex extension stands for Dalvik EXecutable. So we need to decompile these dex files to get the java classes.  Tools  Apktool : tool for reverse engineering Android apk files.",
  "inLanguage" : "en",
  "wordCount":  915 ,
  "datePublished" : "2021-07-21T18:17:00\u002b07:00",
  "dateModified" : "2021-07-21T18:17:00\u002b07:00",
  "image" : "https:\/\/bzoltan1.github.io\/avatar.png",
  "keywords" : [ "Android" ],
  "mainEntityOfPage" : "https:\/\/bzoltan1.github.io\/posts\/androi-pentest-note-p1\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/bzoltan1.github.io\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/bzoltan1.github.io\/avatar.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>


<meta property="og:title" content="Android Pentest Note" />
<meta property="og:description" content="Concept Structure  AndroidManifest file contains the application’s structure Res folder contains all the resources that the application needs to run , including user interface layout, icons, audio, etc. The most interesting files for us are the classes.dex files because they are the compiled java files. The .dex extension stands for Dalvik EXecutable. So we need to decompile these dex files to get the java classes.  Tools  Apktool : tool for reverse engineering Android apk files.">
<meta property="og:image" content="https://bzoltan1.github.io/avatar.png" />
<meta property="og:url" content="https://bzoltan1.github.io/posts/androi-pentest-note-p1/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Zoltán&#39;s Blog" />

  <meta name="twitter:title" content="Android Pentest Note" />
  <meta name="twitter:description" content="Concept Structure  AndroidManifest file contains the application’s structure Res folder contains all the resources that the application needs to run , including user interface layout, icons, audio, …">
  <meta name="twitter:image" content="https://bzoltan1.github.io/avatar.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <link href='https://bzoltan1.github.io/avatar.png' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.83.1" />
  <link rel="alternate" href="https://bzoltan1.github.io/index.xml" type="application/rss+xml" title="Zoltán&#39;s Blog"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://bzoltan1.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://bzoltan1.github.io/css/syntax.css" /><link rel="stylesheet" href="https://bzoltan1.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://bzoltan1.github.io/">Zoltán&#39;s Blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="https://bzoltan1.github.io/">Blog</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="https://bzoltan1.github.io/tags">Tags</a>
            </li>
          
        
          
            <li>
              <a title="Home" href="https://bzoltan1.github.io/">Home</a>
            </li>
          
        
          
            <li>
              <a title="About" href="https://bzoltan1.github.io/about">About</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Zoltán&#39;s Blog" href="https://bzoltan1.github.io/">
            <img class="avatar-img" src="https://bzoltan1.github.io/avatar.png" alt="Zoltán&#39;s Blog" />
           
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="posts-heading">
              
                <h1>Android Pentest Note</h1>
              
              
                <hr class="small">
              
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <h2 id="concept">Concept</h2>
<p><img src="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/1.png" alt="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/1.png">
<img src="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/2.png" alt="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/2.png"></p>
<h4 id="structure">Structure</h4>
<ul>
<li><strong>AndroidManifest file</strong> contains the application’s structure</li>
<li><strong>Res folder</strong> contains all the resources that the application needs to run , including user interface layout, icons, audio, etc.</li>
<li><strong>The most interesting files for us are the classes.dex files</strong> because they are the compiled java files. The .dex extension stands for Dalvik EXecutable. So we need to decompile these dex files to get the java classes.</li>
</ul>
<h4 id="tools">Tools</h4>
<ul>
<li><strong>Apktool</strong> : tool for reverse engineering Android apk files. In this case we are using to extract files from apk and rebuild.</li>
<li><strong>Keytool</strong> : Java tool for creating keys/certs, that comes with the JDK.</li>
<li><strong>Jarsigner</strong> : Java tool for signing JAR/APK files, that comes with the JDK.</li>
<li><strong>Zipalign</strong> : archive alignment tool, that comes with the Android SDK.</li>
<li><strong>JD-GUI</strong> : To view java code.</li>
<li><strong>dex2jar</strong> : Converts Android dex files to class/jar files.</li>
<li><strong>MobSF</strong> : Mobile Security Framework (MobSF) is an automated, all-in-one mobile application (Android/iOS/Windows) pen-testing.</li>
<li><strong>Adb</strong> : is a versatile command-line tool that lets you communicate with a device.</li>
<li><strong>Frida</strong> : Dynamic Binary Instrumentation tool.</li>
<li><strong>How to Frida work?</strong> : Frida is writing code directly in process memory. When you attach frida to a running application, frida on the background uses ptrace to hijack the thread. A bootstrapper populates this thread and starts a new one, connecting to the frida server that is running on the device and loads a dynamically generated library that has the frida agent along with our instrumentation code. This last part is where all the magic happens. The hijacked thread is being restored to its original state and resumes, then the process continues normally. (<a href="https://erev0s.com/blog/frida-code-snippets-for-android/)">https://erev0s.com/blog/frida-code-snippets-for-android/)</a>.</li>
<li><strong>APKLab</strong> : extension VSCode for apk (good).</li>
</ul>
<h2 id="decompile-and-compile">Decompile and compile</h2>
<h4 id="unpack-file-apk">Unpack file apk</h4>
<p><code>unzip application.apk</code></p>
<h4 id="to-decompile-an">To decompile an</h4>
<p><code>apktool d -r -s application.apk</code><br>
or<br>
<code>apktool d application.apk</code><br>
or<br>
<code>java -jar Bytecode-Viewer-2.10.12.jar -&gt; load apk file</code><br>
or<br>
<code>using extension ApkLap in Visual Studio Code</code><br>
or<br>
<code>using jadx</code> (<a href="https://github.com/skylot/jadx/releases/download/v1.2.0/jadx-gui-1.2.0-no-jre-win.exe">https://github.com/skylot/jadx/releases/download/v1.2.0/jadx-gui-1.2.0-no-jre-win.exe</a>)</p>
<h4 id="convert-the-dex-files-into-standard-class-files">Convert the Dex files into standard class files</h4>
<p><code>sh d2j-dex2jar.sh application/classes.dex </code><br>
(classes.dex have from unzip application)</p>
<h4 id="use-the-jd-java-decompiler-to-inspect-the-source">Use the JD (Java Decompiler) to inspect the source</h4>
<p><code>java -jar jd-gui.jar classes-dex2jar.jar</code><br>
or<br>
<code>java -jar recaf-2.20.1-J8-jar-with-dependencies.jar --input=classes-dex2jar.jar</code>\</p>
<ul>
<li>Once you have made your changes, you need to repack the APK. This will create a my_application.apkfile:</li>
</ul>
<h4 id="to-recompilebuild-the-apk">To recompile(build) the apk</h4>
<ul>
<li>After modify apk file (smili code,&hellip;) you can recompile apk app<br>
<code>apktool b -f -d application</code></li>
<li>or<br>
<code>using APKLap in VSCode (https://github.com/APKLab/APKLab)</code></li>
<li>After recompiling (building) the apk the new apk will be generated in Dist folder.(using apk tools)</li>
<li>New apk save in : Application -&gt; Dist -&gt;  application.apk</li>
<li>The APK must be signed before you run on your device.</li>
<li>Before signing an apk, create a key if you don’t have an existing one. If prompted for a password, create your own password.\</li>
<li><strong>To generate a key</strong><br>
<code>keytool -genkey -v -keystore my-release-key.keystore -alias alias_name  -keyalg RSA -keysize 2048 -validity 10000</code></li>
<li><strong>Sign the apk</strong><br>
<code>jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore my_application.apk alias_name</code></li>
<li><strong>Verify apk (Option)</strong><br>
<code>jarsigner -verify -verbose -certs my_application.apk</code></li>
<li>Finally, the apk must be aligned for optimal loading:<br>
<code>./zipalign -v 4 my_application.apk my_application-aligned.apk</code></li>
<li>You have a my_application-aligned.apk file, which you can install onto your device.</li>
</ul>
<h2 id="using-adb-and-frida-interact-android">Using Adb and Frida interact Android</h2>
<h4 id="adb">Adb</h4>
<ul>
<li><code>adb devices</code> : list devices</li>
<li><code>adb connect IP:Port</code> : connect to devices</li>
<li><code>adb shell</code> : spawn shell</li>
<li><code>adb root</code> : run with root user</li>
<li><code>adb backup -apk -shared com.android.insecurebankv2</code> (android:allowBackup=&ldquo;true&rdquo; in AndroidMainfest.xml) : backup apk file</li>
<li><code>cat backup.ab</code> | ( dd bs=24 count=0 skip=1; cat) | zlib-flate-uncompress &gt; backup.tar : read backup file</li>
</ul>
<h4 id="frida">Frida</h4>
<ul>
<li><code>wget https://github.com/frida/frida/releases/download/15.0.0/frida-inject-15.0.0-android-x86.xz</code> : download</li>
<li><code>adb push frida-server /data/local/tmp</code> : push Frida server to Androi</li>
<li><code>adb shell &quot;chmod 755 /data/local/tmp/frida-server&quot;</code>: set permission Frida binari</li>
<li><code>adb shell &quot;/data/local/tmp/frida-server&quot; &amp;</code> : run Frida-server in Android</li>
<li><code>Frida-ps -U</code> : list running process</li>
<li><code>Frida-ps -aU | grep -i &quot;name&quot;</code> : check process name</li>
</ul>
<h4 id="example-frida">Example Frida</h4>
<p><strong>Login bypass</strong></p>
<ul>
<li>APP : Sieve (download apk -&gt; adb install sieve.apk)</li>
<li>A function named “checkKeyResult”. If the boolean value is true, the application redirects the flow to loginSuccessful() function if false then to loginFailed(). 
<img src="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/3.png" alt="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/3.png"></li>
<li>Frida has support for binding with multiple languages like Python,C,.NET and Swift. However, we are using python to demonstrate the bypass</li>
<li>Check process name : <code>frida-ps -aU | grep -i &quot;sieve&quot;</code></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">MainActivity</span> <span class="o">=</span> <span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;com.mwr.example.sieve.MainLoginActivity&#39;</span><span class="p">);</span> <span class="c1">//Obtain referrence of the Activity currently running
</span><span class="c1"></span>    <span class="nx">MainActivity</span><span class="p">.</span><span class="nx">checkKeyResult</span><span class="p">.</span><span class="nx">implementation</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//Obtain reference of the function whcih needs to be called
</span><span class="c1"></span>        <span class="nx">send</span><span class="p">(</span><span class="s1">&#39;checkKeyResult&#39;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">checkKeyResult</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span> <span class="c1">//Calling the function and passing the boolean parameter as true
</span><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Done:&#39;</span><span class="p">);</span>
    <span class="p">};</span>
<span class="p">});</span>
</code></pre></div><ul>
<li>Run: <code>frida -U --no-pause -l bypass.js -f appname</code><br>
<strong>Check root bypass</strong></li>
<li>APP : bankinsecurev2 (download apk -&gt; adb install bankinsecurev2.apk)</li>
<li>The application uses two functions to check whether the device is rooted or not as shown below in the decompiled APK of the InsecureBank app: doesSUexist, doesSuperuserApkExist
<img src="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/5.png" alt="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/5.png"></li>
<li>Script bypass:</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">MainActivity</span> <span class="o">=</span> <span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;com.android.insecurebankv2.PostLogin&#39;</span><span class="p">);</span>
    <span class="nx">MainActivity</span><span class="p">.</span><span class="nx">doesSUexist</span><span class="p">.</span><span class="nx">implementation</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Done: doesSUexist&#39;</span><span class="p">);</span>
		<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">};</span>
	
	<span class="nx">MainActivity</span><span class="p">.</span><span class="nx">doesSuperuserApkExist</span><span class="p">.</span><span class="nx">implementation</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Done: doesSuperuserApkExist&#39;</span><span class="p">);</span>
		<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">});</span>
</code></pre></div><ul>
<li>Running: <code>frida -U --no-pause -l bypass.js -f appname</code><br>
<strong>Real world</strong></li>
<li>Check emulator:<br>
<img src="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/7.PNG" alt="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/7.PNG"></li>
<li>In class StringUtil
<img src="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/9.PNG" alt="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/9.PNG"></li>
<li>Check root:<br>
<img src="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/8.PNG" alt="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/8.PNG"></li>
<li>In class RootUtil
<img src="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/10.PNG" alt="https://raw.githubusercontent.com/l3mnt2010/Blog_Image/master/androi/10.PNG"></li>
<li>Bypass check emulator and root (overload 2 method a() in StringUtil and a() in RootUtil):</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;\nBypass emulator detection&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">StringUtil</span> <span class="o">=</span> <span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;package.name&#39;</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;\nHijacking a() function in StringUtil class&#39;</span><span class="p">);</span>
    <span class="nx">StringUtil</span><span class="p">.</span><span class="nx">a</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s1">&#39;java.lang.String&#39;</span><span class="p">).</span><span class="nx">implementation</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;\nInside the a() function&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;\nEmulator detection bypassed&#39;</span><span class="p">);</span>


    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;\nBypass root detection&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">RootUtil</span> <span class="o">=</span> <span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;package.name&#39;</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;\nHijacking a() function in RootUtil class&#39;</span><span class="p">);</span>
    <span class="nx">RootUtil</span><span class="p">.</span><span class="nx">a</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s1">&#39;android.content.Context&#39;</span><span class="p">).</span><span class="nx">implementation</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;\nInside the a() function&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;\nRoot detection bypassed&#39;</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div><ul>
<li>Running: <code>frida -U --no-pause -l bypass.js -f appname</code></li>
</ul>
<h2 id="refer">Refer</h2>
<p><a href="https://frida.re/docs">https://frida.re/docs</a><br>
<a href="https://11x256.github.io/Frida-hooking-android-part-1/">https://11x256.github.io/Frida-hooking-android-part-1/</a><br>
<a href="https://11x256.github.io/Frida-hooking-android-part-2/">https://11x256.github.io/Frida-hooking-android-part-2/</a><br>
<a href="https://notsosecure.com/pentesting-android-apps-using-frida/">https://notsosecure.com/pentesting-android-apps-using-frida/</a></p>


        
          <div class="blog-tags">
            
              
              <a href="https://bzoltan1.github.io/tags/android/">Android</a>&nbsp;
            
          </div>
        

        

        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://bzoltan1.github.io/posts/2024-01-17-insecure-deserialization-lab/" data-toggle="tooltip" data-placement="top" title="Insecure-deserialization-lab">&larr; Previous Post</a>
            </li>
          
          
        </ul>
      


      

    </div>
  </div>
</div>

      <footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
        </ul>
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;&copy;
          
            2021
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://bzoltan1.github.io/">Zoltán&#39;s Blog</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.83.1</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="https://bzoltan1.github.io/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://bzoltan1.github.io/js/load-photoswipe.js"></script>










    
  </body>
</html>

